<div class="<{$className}>">
<{foreach item=cat from=$tree name=tree key=k}>
<{if $smarty.foreach.tree.first}>
<{assign var=d value=$cat->getDepth()}>
<{/if}>
<{assign var=catId value=$cat->getShow('cat_id')}>

<{if $smarty.foreach.tree.first || $d < $cat->getDepth()}>
  <ul class="catL<{$cat->getDepth()}>">
    <li><a href="<{xoops_cooluri dirname=$dirname dataname=page query="category_id=`$catId`"}>"><{$cat->getShow('title')}></a> (<{$countArr[$k]}>)</li>
<{elseif $d==$cat->getDepth()}>
    <li><a href="<{xoops_cooluri dirname=$dirname dataname=page query="category_id=`$catId`"}>"><{$cat->getShow('title')}></a> (<{$countArr[$k]}>)</li>
<{else}>
  <{section name=i start=0 loop=$d-$cat->getDepth()}>
  </ul>
  <{/section}>
    <li><a href="<{xoops_cooluri dirname=$dirname dataname=page query="category_id=`$catId`"}>"><{$cat->getShow('title')}></a> (<{$countArr[$k]}>)</li>
<{/if}>
<{if $smarty.foreach.tree.last}>
  <{section name=i start=0 loop=$cat->getDepth()}>
  </ul>
  <{/section}>
<{/if}>
<{assign var=d value=$cat->getDepth()}>
<{/foreach}>
</div>